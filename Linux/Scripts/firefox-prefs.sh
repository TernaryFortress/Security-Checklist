#!/usr/bin/env bash
set -e

# Your profile name
iam="$(logname)"

# The prefs.js file lives in a hidden folder with a random name. This finds that folder for us.
userProfile=$(ls -d /home/$iam/snap/firefox/common/.mozilla/firefox/*.default 2>/dev/null | head -n 1)

cat <<EOF_FF > "${userProfile}/user.js"
user_pref("general.useragent.override", "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36");
user_pref("app.update.auto", false);
user_pref("app.update.enabled", false);
user_pref("app.update.lastUpdateTime.addon-background-update-timer", 1182011519);
user_pref("app.update.lastUpdateTime.background-update-timer", 1182011519);
user_pref("app.update.lastUpdateTime.blocklist-background-update-timer", 1182010203);
user_pref("app.update.lastUpdateTime.microsummary-generator-update-timer", 1222586145);
user_pref("app.update.lastUpdateTime.search-engine-update-timer", 1182010203);
user_pref("beacon.enabled", false);
user_pref("browser.casting.enabled", false);
user_pref("browser.contentanalysis.enabled", false);
user_pref("browser.discovery.enabled", false);
user_pref("browser.ml.modelHubRootUrl", "");
user_pref("browser.newtabpage.activity-stream.enabled", false);
user_pref("browser.newtabpage.activity-stream.telemetry", false);
user_pref("browser.newtabpage.activity-stream.feeds.telemetry", false);
user_pref("browser.newtabpage.activity-stream.telemetry.ut.events", false);
user_pref("browser.newtabpage.activity-stream.feeds.recommendationprovider", false);
user_pref("browser.newtabpage.activity-stream.discoverystream.merino-provider.endpoint", "");
user_pref("browser.newtabpage.activity-stream.telemetry.structuredIngestion.endpoint", "");
user_pref("browser.newtabpage.activity-stream.showWeather", false);
user_pref("browser.newtabpage.activity-stream.system.showWeather", false);
user_pref("browser.newtabpage.activity-stream.weather.locationSearchEnabled", false);
user_pref("browser.partnerlink.attributionURL", "");
user_pref("browser.pagethumbnails.capturing_disabled", false);
user_pref("browser.search.serpEventTelemetry.enabled", false);
user_pref("browser.region.network.url", "");
user_pref("browser.search.geoip.url", "");
user_pref("browser.shell.checkDefaultBrowser", false);
user_pref("browser.shopping.experience2023.ads.enabled", false);
user_pref("browser.shopping.experience2023.ads.exposure", false);
user_pref("browser.shopping.experience2023.ads.userEnabled", false);
user_pref("browser.tabs.crashReporting.sendReport", false);
user_pref("browser.topsites.contile.enabled", false);
user_pref("browser.topsites.contile.endpoint", "");
user_pref("browser.urlbar.autocomplete.enabled", false);
user_pref("browser.urlbar.contextualSearch.enabled", false);
user_pref("browser.urlbar.merino.endpointURL", "");
user_pref("browser.urlbar.pocket.featureGate", false);
user_pref("browser.urlbar.quicksuggest.allowPositionInSuggestions", false);
user_pref("browser.urlbar.quicksuggest.dataCollection.enabled", false);
user_pref("browser.urlbar.speculativeConnect.enabled", false);
user_pref("browser.urlbar.suggest.pocket", false);
user_pref("browser.urlbar.suggest.quicksuggest.sponsored", false);
user_pref("browser.urlbar.suggest.remotetab", false);
user_pref("browser.urlbar.suggest.topsites", false);
user_pref("browser.urlbar.suggest.trending", false);
user_pref("browser.urlbar.suggest.weather", false);
user_pref("browser.urlbar.suggest.yelp", false);
user_pref("browser.urlbar.weather.ignoreVPN", false);
user_pref("browser.urlbar.yelp.featureGate", false);
user_pref("camera.control.face_detection.enabled", false);
user_pref("clipboard.autocopy", false);
user_pref("datareporting.healthreport.service.enabled", false);
user_pref("device.sensors.enabled", false);
user_pref("device.sensors.ambientLight.enabled", false);
user_pref("device.sensors.motion.enabled", false);
user_pref("device.sensors.orientation.enabled", false);
user_pref("device.sensors.proximity.enabled", false);
user_pref("devtools.browserconsole.enableNetworkMonitoring", false);
user_pref("dom.network.enabled", false);
user_pref("dom.reporting.enabled", false);
user_pref("dom.reporting.featurePolicy.enabled", false);
user_pref("dom.reporting.testing.enabled", false);
user_pref("dom.telephony.enabled", false);
user_pref("dom.text-recognition.enabled", false);
user_pref("experiments.enabled", false);
user_pref("geo.enabled", false);
user_pref("geo.provider.ms-windows-location", false);
user_pref("geo.provider.network.url", "");
user_pref("geo.provider.use_geoclue", false);
user_pref("geo.provider.use_gpsd", false);
user_pref("geo.wifi.logging.enabled", false);
user_pref("geo.wifi.uri", "");
user_pref("identity.fxaccounts.toolbar.pxiToolbarEnabled.monitorEnabled", false);
user_pref("identity.mobilepromo.android", "");
user_pref("keyword.enabled", false);
user_pref("media.aboutwebrtc.auto_refresh.peerconnection_section", false);
user_pref("media.aboutwebrtc.auto_refresh.user_modified_config_section", false);
user_pref("media.devices.enumerate.legacy.enabled", false);
user_pref("media.getusermedia.screensharing.enabled", false);
user_pref("media.gmp-manager.allowLocalSources", false);
user_pref("media.gmp-provider.enabled", false);
user_pref("media.navigator.enabled", false);
user_pref("media.navigator.permission.disabled", true);
user_pref("media.peerconnection.allow_old_setParameters", false);
user_pref("media.peerconnection.enabled", false);
user_pref("media.peerconnection.ice.no_host", true);
user_pref("media.peerconnection.ice.stun_client_maximum_transmits", 0);
user_pref("media.peerconnection.mtransport_process", false);
user_pref("media.peerconnection.scripttransform.enabled", false);
user_pref("media.peerconnection.turn.disable", true);
user_pref("media.peerconnection.video.use_rtx", false);
user_pref("media.webrtc.capture.allow-pipewire", false);
user_pref("media.webspeech.recognition.enable", false);
user_pref("messaging-system.rsexperimentloader.enabled", false);
user_pref("media.video_stats.enabled", false);
user_pref("network.allow-experiments", false);
user_pref("network.http.referer.spoofSource", true);
user_pref("network.predictor.enabled", false);
user_pref("network.prefetch-next", false);
user_pref("network.proxy.enable_wpad_over_dhcp", false);
user_pref("network.proxy.system_wpad", false);
user_pref("network.proxy.system_wpad.allowed", false);
user_pref("network.traffic_analyzer.enabled", false);
user_pref("network.trr.confirmation_telemetry_enabled", false);
user_pref("pdfjs.enableScripting", false);
user_pref("places.history.enabled", false);
user_pref("privacy.donottrackheader.enabled", true);
user_pref("privacy.fingerprintingProtection", true);
user_pref("security.certerrors.recordEventTelemetry", false);
user_pref("security.protectionspopup.recordEventTelemetry", false);
user_pref("security.ssl.errorReporting.automatic", false);
user_pref("services.sync.prefs.sync.browser.discovery.enabled", false);
user_pref("services.sync.prefs.sync.browser.newtabpage.activity-stream.section.highlights.includePocket", false);
user_pref("services.sync.prefs.sync.browser.newtabpage.activity-stream.showSponsored", false);
user_pref("services.sync.prefs.sync.browser.newtabpage.activity-stream.showSponsoredTopSites", false);
user_pref("services.sync.prefs.sync.privacy.donottrackheader.enabled", true);
user_pref("toolkit.telemetry.bhrPing.enabled", false);
user_pref("toolkit.telemetry.cachedClientID", "");
user_pref("toolkit.telemetry.cachedProfileGroupID", "");
user_pref("toolkit.telemetry.dap_helper", "");
user_pref("toolkit.telemetry.dap_leader", "");
user_pref("toolkit.telemetry.enabled", false);
user_pref("toolkit.telemetry.archive.enabled", false);
user_pref("toolkit.telemetry.rejected", true);
user_pref("toolkit.telemetry.server", "");
user_pref("toolkit.telemetry.unified", false);
user_pref("toolkit.telemetry.unifiedIsOptIn", false);
user_pref("toolkit.telemetry.updatePing.enabled", false);
EOF_FF
