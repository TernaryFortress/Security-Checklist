#!/bin/bash

#sudo apparmor_parser -r /var/lib/snapd/apparmor/profiles/snap.firefox.firefox
#sudo chmod -w /var/lib/snapd/apparmor/profiles/snap.firefox.firefox
#sudo chattr -i /var/lib/snapd/apparmor/profiles/snap.firefox.firefox
#sudo chattr +i /var/lib/snapd/apparmor/profiles/snap.firefox.firefox

iam="${1:-$(logname)}"
userProfile=$(ls -d /home/$iam/snap/firefox/common/.mozilla/firefox/*.default 2>/dev/null | head -n 1)
apparmorPath="/var/lib/snapd/apparmor/profiles/snap.firefox.firefox"
# For the most part, the directories that are able to be written to externally are:
# /var/tmp, /dev, /memfd, and /tmp
# These should be protected to the fullest extent possible by any profile without fail.

chattr -i "$apparmorPath"
chmod +w "$apparmorPath"

sed -i ':a;N;$!ba;s/}\s*$//' "$apparmorPath"

cat <<EOF_FF >> "$apparmorPath"
# No editing your own rules!
deny /var/lib/snapd/apparmor/profiles/snap.firefox.firefox xw,
deny /etc/firefox/policies/policies.json xw,
deny $userProfile/user.js xw,

#  ----- Our Apparmor Firefox Policy starts here -----
# We require /dev, /etc, /home, /proc, /run, /snap, and /usr directories to function
# Apparmor also whitelists /sys and /var, however our /var directories are empty.
# Other symbols: /
deny /[-_.:+/gftq]** xrw,
deny /[0-9]** xrw,
deny /[a-c]** xrw,
deny /[i-o]** xrw,
deny /[v-z]** xrw,
deny /d[^e]** xrw,
deny /de[^v]** xrw,
deny /dev[^/]** xrw,
deny /e[^t]** xrw,
deny /et[^c]** xrw,
deny /etc[^/]** xrw,
deny /h[^o]** xrw,
deny /ho[^m]** xrw,
deny /hom[^e]** xrw,
deny /home[^/]** xrw,
deny /p[^r]** xrw,
deny /pr[^o]** xrw,
deny /pro[^c]** xrw,
deny /proc[^/]** xrw,
deny /r[^u]** xrw,
deny /ru[^n]** xrw,
deny /run[^/]** xrw,
deny /s[-_z.+/]** xrw,
deny /s[0-9]** xrw,
deny /s[a-m]** xrw,
deny /s[o-x]** xrw,
deny /sn[^a]** xrw,
deny /sna[^p]** xrw,
deny /snap[^/]** xrw,
deny /sy[^s]** xrw,
deny /sys[^/]** xrw,
deny /u[^s]** xrw,
deny /us[^r]** xrw,
deny /usr[^/]** xrw,

deny /home/*/bin/** xrw,
deny /**Desktop** xrw,
deny /**media** xrw,
deny /{,usr/}bin/** xrw,

deny /**bash** xrw,
deny /**sudo** xrw,
deny /**mknod** xwr,
deny /**chmod** xwr,
deny /**chattr** xwr,

# Prevent lateral movement.
deny /**su** x,
deny /**sh** x,
deny /**mv** x,
deny /**cp** x,
deny /**py** x,
deny /**ln** x,
deny /**mount** x,
deny /**remount** x,
deny /**umount** x,

# --- /dev directory ---
/dev/hidraw[0-9] rw,
deny /dev/[-._:+tu]** xrw,
deny /dev/[0-9]** xrw,
deny /dev/[a-c]** xrw,
deny /dev/[e-g]** xrw,
deny /dev/[i-m]** xrw,
deny /dev/[o-r]** xrw,
deny /dev/[w-z]** xrw,
deny /dev/d[^r]** xrw,
deny /dev/dr[^i]** xrw,
deny /dev/dri/ xw,
deny /dev/dri/[-._:+ab/]** xw,
deny /dev/dri/[0-9]** xw,
deny /dev/dri/[d-q]** xw,
deny /dev/dri/[s-z]** xw,
deny /dev/dri/c[^a]** xw,
deny /dev/dri/ca[^r]** xw,
deny /dev/dri/car[^d]** xw,
deny /dev/dri/card[-._:+/]** xw,
deny /dev/dri/card[0-9]*/** xw,
deny /dev/dri/card[a-z]** xw,
deny /dev/dri/r[^e]** xw,
deny /dev/dri/re[^n]** xw,
deny /dev/dri/ren[^d]** xw,
deny /dev/dri/rend[^e]** xw,
deny /dev/dri/rende[^r]** xw,
deny /dev/dri/render[^D]** xw,
deny /dev/dri/renderD[0-9]*/** xw,
deny /dev/dri[^/]** xrw,
deny /dev/h[^i]** xrw,
deny /dev/hi[^d]** xrw,
deny /dev/hid[^r]** xrw,
deny /dev/hidr[^a]** xrw,
deny /dev/hidra[^w]** xrw,
deny /dev/hidraw[-._:+/]** xrw,
deny /dev/hidraw[-._:+/]** xrw,
deny /dev/hidraw[0-9] x,
deny /dev/hidraw[0-9]*/** xrw,
deny /dev/hidraw[0-9]?** xrw,
deny /dev/hidraw[a-z]** xrw,
deny /dev/n[-._:+/]** xrw,
deny /dev/n[0-9]** xrw,
deny /dev/n[a-t]** xrw,
deny /dev/n[w-z]** xrw,
deny /dev/nu[^l]** xrw,
deny /dev/nul[^l]** xrw,
deny /dev/null xw,
deny /dev/null*/** xrw,
deny /dev/null?** xrw,
deny /dev/nv[-._:+/]** xrw,
deny /dev/nv[0-9]** xrw,
deny /dev/nv[a-g]** xrw,
deny /dev/nv[j-l]** xrw,
deny /dev/nv[n-z]** xrw,
deny /dev/nvh[^o]** xrw,
deny /dev/nvho[^s]** xrw,
deny /dev/nvhos[^t]** xrw,
deny /dev/nvhost-*/** xrw,
deny /dev/nvhost[^-]** xrw,
deny /dev/nvi[^d]** xrw,
deny /dev/nvid[^i]** xrw,
deny /dev/nvidi[^a]** xrw,
deny /dev/nvidia*/** xrw,
deny /dev/nvm[^a]** xrw,
deny /dev/nvma[^p]** xrw,
deny /dev/nvmap*/** xrw,
deny /dev/nvmap?* xrw,
deny /dev/s[^h]** xrw,
deny /dev/sh[^m]** xrw,
deny /dev/shm/[^c]** xrw,
deny /dev/shm/c[^u]** xrw,
deny /dev/shm/cu[^d]** xrw,
deny /dev/shm/cud[^a]** xrw,
deny /dev/shm/cuda.*/** xrw,
deny /dev/shm/cuda[^.]** xrw,
deny /dev/shm[^/]** xrw,
deny /dev/v[^c]** xrw,
deny /dev/vc[-._:+/]** xrw,
deny /dev/vc[0-9]** xrw,
deny /dev/vc[a-g]** xrw,
deny /dev/vc[i-r]** xrw,
deny /dev/vc[t-z]** xrw,
deny /dev/vch[^i]** xrw,
deny /dev/vchi[^q]** xrw,
deny /dev/vchiq*/** xrw,
deny /dev/vchiq?** xrw,
deny /dev/vcs[^m]** xrw,
deny /dev/vcsm-[^c]** xrw,
deny /dev/vcsm-c[^m]** xrw,
deny /dev/vcsm-cm[^a]** xrw,
deny /dev/vcsm-cma*/** xrw,
deny /dev/vcsm-cma?** xrw,
deny /dev/vcsm[^-]** xrw,

# --- /etc directory ---
/etc/firefox/certificates/** r,
/etc/firefox/policies/** r,


deny /etc/[-._+:/]** xrw,
deny /etc/[0-9]** xrw,
deny /etc/a[^l]** xrw,
deny /etc/al[^t]** xrw,
deny /etc/alt[^e]** xrw,
deny /etc/alte[^r]** xrw,
deny /etc/alter[^n]** xrw,
deny /etc/altern[^a]** xrw,
deny /etc/alterna[^t]** xrw,
deny /etc/alternat[^i]** xrw,
deny /etc/alternati[^v]** xrw,
deny /etc/alternativ[^e]** xrw,
deny /etc/alternative[^s]** xrw,
deny /etc/alternative[^/]** xrw,
deny /etc/alternative/[^x]** xrw,
deny /etc/alternative/x[^-]** xrw,
deny /etc/alternative/x-[^w]** xrw,
deny /etc/alternative/x-w[^w]** xrw,
deny /etc/alternative/x-ww[^w]** xrw,
deny /etc/alternative/x-www[^-]** xrw,
deny /etc/alternative/x-www-[^b]** xrw,
deny /etc/alternative/x-www-b[^r]** xrw,
deny /etc/alternative/x-www-br[^o]** xrw,
deny /etc/alternative/x-www-bro[^w]** xrw,
deny /etc/alternative/x-www-brow[^s]** xrw,
deny /etc/alternative/x-www-brows[^e]** xrw,
deny /etc/alternative/x-www-browse[^r]** xrw,
deny /etc/alternative/x-www-browser*/** xrw,
deny /etc/alternative/x-www-browser?** xrw,
deny /etc/alternative/x-www-browser xw,
deny /etc/[b-e]** xrw,
deny /etc/[i-q]** xrw,
deny /etc/[s-u]** xrw,
deny /etc/[w-z]** xrw,
deny /etc/f[^i]** xrw,
deny /etc/fi[^r]** xrw,
deny /etc/fir[^e]** xrw,
deny /etc/fire[^f]** xrw,
deny /etc/firef[^o]** xrw,
deny /etc/firefo[^x]** xrw,
deny /etc/firefox/[-._:+ab/]** xrw,
deny /etc/firefox/[0-9]** xrw,
deny /etc/firefox/[d-o]** xrw,
deny /etc/firefox/[q-z]** xrw,
deny /etc/firefox/c[^e]*/** xrw,
deny /etc/firefox/ce[^r]*/** xrw,
deny /etc/firefox/cer[^t]*/** xrw,
deny /etc/firefox/cert[^i]*/** xrw,
deny /etc/firefox/certi[^f]*/** xrw,
deny /etc/firefox/certif[^i]*/** xrw,
deny /etc/firefox/certifi[^c]*/** xrw,
deny /etc/firefox/certific[^a]*/** xrw,
deny /etc/firefox/certifica[^t]*/** xrw,
deny /etc/firefox/certificat[^e]*/** xrw,
deny /etc/firefox/certificate[^s]*/** xrw,
deny /etc/firefox/certificates/** xw,
deny /etc/firefox/certificates[^/]** xrw,
deny /etc/firefox/p[^o]** xrw,
deny /etc/firefox/po[^l]** xrw,
deny /etc/firefox/pol[^i]** xrw,
deny /etc/firefox/poli[^c]** xrw,
deny /etc/firefox/polic[^i]** xrw,
deny /etc/firefox/polici[^e]*/** xrw,
deny /etc/firefox/policie[^s]*/** xrw,
deny /etc/firefox/policies/** xw,
deny /etc/firefox/policies[^/]** xrw,
deny /etc/g[-._+:/]** xrw,
deny /etc/g[0-9]** xrw,
deny /etc/g[a-m]** xrw,
deny /etc/g[n-s]** xrw,
deny /etc/g[u-z]** xrw,
deny /etc/gn[^o]** xrw,
deny /etc/gno[^m]** xrw,
deny /etc/gnom[^e]** xrw,
deny /etc/gnome/[^d]** xrw,
deny /etc/gnome/d[^e]** xrw,
deny /etc/gnome/de[^f]** xrw,
deny /etc/gnome/def[^a]** xrw,
deny /etc/gnome/defa[^u]** xrw,
deny /etc/gnome/defau[^l]** xrw,
deny /etc/gnome/defaul[^t]** xrw,
deny /etc/gnome/default[^s]** xrw,
deny /etc/gnome/defaults.[^l]** xrw,
deny /etc/gnome/defaults.l[^i]** xrw,
deny /etc/gnome/defaults.li[^s]** xrw,
deny /etc/gnome/defaults.lis[^t]** xrw,
deny /etc/gnome/defaults.list xw,
deny /etc/gnome/defaults.list*/** xrw,
deny /etc/gnome/defaults.list?** xrw,
deny /etc/gnome/defaults[^.]** xrw,
deny /etc/gnome[^/]** xrw,
deny /etc/gt[^k]** xrw,
deny /etc/gtk-*/* xw,
deny /etc/gtk[^-]** xrw,
deny /etc/h[-._+:/]** xrw,
deny /etc/h[0-9]** xrw,
deny /etc/h[^o]** xrw,
deny /etc/ho[^s]** xrw,
deny /etc/hos[^t]** xrw,
deny /etc/host.[^c]** xrw,
deny /etc/host.c[^o]** xrw,
deny /etc/host.co[^n]** xrw,
deny /etc/host.con[^f]** xrw,
deny /etc/host.conf xw,
deny /etc/host.conf*/** xrw,
deny /etc/host.conf?** xrw,
deny /etc/host[-_+:]** xrw,
deny /etc/host[0-9]** xrw,
deny /etc/host[a-m]** xrw,
deny /etc/host[o-r]** xrw,
deny /etc/host[t-z]** xrw,
deny /etc/hostn[^a]** xrw,
deny /etc/hostna[^m]** xrw,
deny /etc/hostnam[^e]** xrw,
deny /etc/hostname xw,
deny /etc/hostname*/** xrw,
deny /etc/hostname?** xrw,
deny /etc/hosts xw,
deny /etc/hosts.[-_+:bc]** xrw,
deny /etc/hosts.[0-9]** xrw,
deny /etc/hosts.[e-z]** xrw,
deny /etc/hosts.a[^l]** xrw,
deny /etc/hosts.al[^l]** xrw,
deny /etc/hosts.all[^o]** xrw,
deny /etc/hosts.allo[^w]** xrw,
deny /etc/hosts.allow xw,
deny /etc/hosts.allow*/** xrw,
deny /etc/hosts.allow?** xrw,
deny /etc/hosts.d[^e]** xrw,
deny /etc/hosts.de[^n]** xrw,
deny /etc/hosts.den[^y]** xrw,
deny /etc/hosts.deny xw,
deny /etc/hosts.deny*/** xrw,
deny /etc/hosts.deny?** xrw,
deny /etc/hosts[^.]** xrw,
deny /etc/r[^e]** xrw,
deny /etc/re[^s]** xrw,
deny /etc/res[^o]** xrw,
deny /etc/reso[^l]** xrw,
deny /etc/resol[^v]** xrw,
deny /etc/resolv.[^c]** xrw,
deny /etc/resolv.c[^o]** xrw,
deny /etc/resolv.co[^n]** xrw,
deny /etc/resolv.con[^f]** xrw,
deny /etc/resolv.conf xw,
deny /etc/resolv.conf*/** xrw,
deny /etc/resolv.conf?** xrw,
deny /etc/resolv[^.]** xrw,
deny /etc/v[^d]** xrw,
deny /etc/vd[^p]** xrw,
deny /etc/vdp[^a]** xrw,
deny /etc/vdpa[^u]** xrw,
deny /etc/vdpau[^_]** xrw,
deny /etc/vdpau_[^w]** xrw,
deny /etc/vdpau_w[^r]** xrw,
deny /etc/vdpau_wr[^a]** xrw,
deny /etc/vdpau_wra[^p]** xrw,
deny /etc/vdpau_wrap[^p]** xrw,
deny /etc/vdpau_wrapp[^e]** xrw,
deny /etc/vdpau_wrappe[^r]** xrw,
deny /etc/vdpau_wrapper.[^c]** xrw,
deny /etc/vdpau_wrapper.c[^f]** xrw,
deny /etc/vdpau_wrapper.cf[^g]** xrw,
deny /etc/vdpau_wrapper.cfg xw,
deny /etc/vdpau_wrapper.cfg*/** xrw,
deny /etc/vdpau_wrapper.cfg?** xrw,
deny /etc/vdpau_wrapper[^.]** xrw,

# --- /home directory ---
/home/*/Documents/** r,
/home/*/Downloads/** w,

# As of now, we deny access to even the admin profiles.
# "/home/*/snap/firefox/common/.mozilla/" directory contains /firefox and /extensions directories.
#
# There are also some potentially problematic telemetry options that websites might have unrestricted access to.
# /home/*/snap/firefox/common/.mozilla/**.default

deny /home/*/[-_:+/]** xrw,
deny /home/*/[0-9]** xrw,
deny /home/*/[a-c]** xrw,
deny /home/*/[e-r]** xrw,
deny /home/*/[t-z]** xrw,
deny /home/*/D[^o]** xrw,
deny /home/*/Do[-._+:ab/]** xrw,
deny /home/*/Do[0-9]** xrw,
deny /home/*/Do[d-v]** xrw,
deny /home/*/Do[x-z]** xrw,
deny /home/*/Doc[^u]** xrw,
deny /home/*/Docu[^m]** xrw,
deny /home/*/Docum[^e]** xrw,
deny /home/*/Docume[^n]** xrw,
deny /home/*/Documen[^t]** xrw,
deny /home/*/Document[^s]** xrw,
deny /home/*/Documents[^/]** xrw,
deny /home/*/Documents?/** xrw,
deny /home/*/Documents/** xw,
deny /home/*/Dow[^n]** xrw,
deny /home/*/Down[^l]** xrw,
deny /home/*/Downl[^o]** xrw,
deny /home/*/Downlo[^a]** xrw,
deny /home/*/Downloa[^d]** xrw,
deny /home/*/Download[^s]** xrw,
deny /home/*/Downloads[^/]** xrw,
deny /home/*/Downloads?/** xrw,
deny /home/*/Downloads/** x,
deny /home/*/s[^n]** xrw,
deny /home/*/sn[^a]** xrw,
deny /home/*/sna[^p]/** xrw,
deny /home/*/snap/[^f]** xrw,
deny /home/*/snap/f[^i]** xrw,
deny /home/*/snap/fi[^r]** xrw,
deny /home/*/snap/fir[^e]** xrw,
deny /home/*/snap/fire[^f]** xrw,
deny /home/*/snap/firef[^o]** xrw,
deny /home/*/snap/firefo[^x]** xrw,
deny /home/*/snap/firefox/[-.:+/ab]** xrw,
deny /home/*/snap/firefox/[0-9]** xrw,
deny /home/*/snap/firefox/[d-z]** xrw,
deny /home/*/snap/firefox/c[-.:+/ab]** xrw,
deny /home/*/snap/firefox/c[0-9]** xrw,
deny /home/*/snap/firefox/c[a-n]** xrw,
deny /home/*/snap/firefox/c[p-t]** xrw,
deny /home/*/snap/firefox/c[v-z]** xrw,
deny /home/*/snap/firefox/co[^m]** xrw,
deny /home/*/snap/firefox/com[^m]** xrw,
deny /home/*/snap/firefox/comm[^o]** xrw,
deny /home/*/snap/firefox/commo[^n]** xrw,
deny /home/*/snap/firefox/common/.[0-9]** xrw,
deny /home/*/snap/firefox/common/.[d-l]** xrw,
deny /home/*/snap/firefox/common/.[n-z]** xrw,
deny /home/*/snap/firefox/common/.c[^a]** xrw,
deny /home/*/snap/firefox/common/.ca[^c]** xrw,
deny /home/*/snap/firefox/common/.cac[^h]** xrw,
deny /home/*/snap/firefox/common/.cach[^e]** xrw,
deny /home/*/snap/firefox/common/.cache[^/]** xrw,
deny /home/*/snap/firefox/common/.cache/[^m]** xrw,
deny /home/*/snap/firefox/common/.cache/m[^o]** xrw,
deny /home/*/snap/firefox/common/.cache/mo[^z]** xrw,
deny /home/*/snap/firefox/common/.cache/moz[^i]** xrw,
deny /home/*/snap/firefox/common/.cache/mozi[^l]** xrw,
deny /home/*/snap/firefox/common/.cache/mozil[^l]** xrw,
deny /home/*/snap/firefox/common/.cache/mozill[^a]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla[^/]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/[^f]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/f[^i]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/fi[^r]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/fir[^e]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/fire[^f]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firef[^o]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefo[^x]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox[^/]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**[^.]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.[^d]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.d[^e]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.de[^f]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.def[^a]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.defa[^u]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.defau[^l]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.defaul[^t]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.default[^/]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.default/[-._:+/ab]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.default/[d-r]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.default/s** xw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.default/[u-z]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.default/[0-9]** xrw,

# activity-stream, safebrowsing folder, thumbnails, cache2, and startupCache.
deny /home/*/snap/firefox/common/.m[^o]** xrw,
deny /home/*/snap/firefox/common/.mo[^z]** xrw,
deny /home/*/snap/firefox/common/.moz[^i]** xrw,
deny /home/*/snap/firefox/common/.mozi[^l]** xrw,
deny /home/*/snap/firefox/common/.mozil[^l]** xrw,
deny /home/*/snap/firefox/common/.mozill[^a]** xrw,
deny /home/*/snap/firefox/common/.mozilla[^/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/[^f]** xrw,
deny /home/*/snap/firefox/common/.mozilla/f[^i]** xrw,
deny /home/*/snap/firefox/common/.mozilla/fi[^r]** xrw,
deny /home/*/snap/firefox/common/.mozilla/fir[^e]** xrw,
deny /home/*/snap/firefox/common/.mozilla/fire[^f]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firef[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefo[^x]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox[^/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/Crash** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/Pending** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/profile** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.def[^a]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.defa[^u]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.defau[^l]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.defaul[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default[^/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/a[^d]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/ad[^d]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/add[^o]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addo[^n]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addon[^s]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons[a-r]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons[t-z]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons[-_:+/]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons.[^j]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons.j[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons.js[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons.jso[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons.json xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons.json?** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonSt[^a]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonSta[^r]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStar[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStart[^u]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStartu[^p]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStartup[^.]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStartup.[^j]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStartup.j[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStartup.js[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStartup.jso[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStartup.json[^.]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStartup.json.[^l]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStartup.json.l[^z]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStartup.json.lz[^4]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStartup.json.lz4 xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addonStartup.json.lz4?** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/[-.:+/dqrt]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/c[a-d]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/c[f-n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/c[p-z]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/c[-.:+/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/ce[^r]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/cer[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/cert[^9]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/cert9[^.]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/cert9.[^d]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/cert9.d[^b]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/cert9.db xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/cert9.db?** xrw,
# Whitelisting cookies seems to not actually enable reads on cookies. This is with only a-c rules setup, so idk. But it's also of minimal irritation, and may perhaps even be beneficial for now.
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/co[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/con[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/cont[^a]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/conta[^i]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/contai[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/contain[^e]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/containe[^r]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/container[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/containers[^.]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/containers.[^j]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/containers.j[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/containers.js[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/containers.jso[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/containers.json x,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/containers.json?** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/e[a-m]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/e[o-w]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/e[y-z]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/e[-.:+/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/ex[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/ext[^e]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/exte[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/exten[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extens[^i]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extensi[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extensio[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension[a-r]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension[t-z]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension[._:+/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-[a-o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-[t-z]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-[-_.:+/qr]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-s[a-d]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-s[f-s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-s[u-z]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-s[-_.:+/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-st[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-sto[^r]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-stor[^e]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-store[^/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-store/** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-se[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-set[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-sett[^i]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-setti[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-settin[^g]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-setting[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-settings[^.]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-settings.[^j]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-settings.j[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-settings.js[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-settings.jso[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-settings.json xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extension-settings.json?** xrw,
# Need "extension-store/", "extension-settings.json", "extension-preferences.json"
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extensions[a-z]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extensions[-:+]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extensions/** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extensions.[^j]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extensions.j[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extensions.js[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extensions.jso[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extensions.json x,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/extensions.json?** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/f[b-n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/f[p-z]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/f[-_.:+/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/f[^a]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/fa[^v]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/fav[^i]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favi[^c]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favic[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favico[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicon[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons[^.]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons.[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons.s[^q]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons.sq[^l]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons.sql[^i]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons.sqli[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons.sqlite x,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons.sqlite[^-]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons.sqlite-[^w]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons.sqlite-w[^a]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons.sqlite-wa[^l]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons.sqlite-wal x,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/favicons.sqlite-wal?** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/[g-j]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/k[^e]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/ke[^y]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/key[^4]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/key4[^.]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/key4.[^d]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/key4.d[^b]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/key4.db xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/key4.db?** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/l[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/lo[^c]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/loc[^k]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/lock x,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/lock?** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/[m-o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/p[a-d]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pe[^r]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/per[^m]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/perm[^i]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permi[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permis[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permiss[^i]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permissi[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permissio[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permission[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permissions[^.]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permissions.[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permissions.s[^q]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permissions.sq[^l]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permissions.sql[^i]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permissions.sqli[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permissions.sqlit[^e]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permissions.sqlite xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/permissions.sqlite?** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/p[f-j]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pk[^c]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pkc[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pkcs[^1]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pkcs1[^1]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pkcs11[^.]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pkcs11.[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pkcs11.t[^x]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pkcs11.tx[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pkcs11.txt xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pkcs11.txt?** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pl[^a]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pla[^c]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/plac[^e]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/place[^s]** xrw,
# !!
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/places[^.]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/places.** x,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/p[m-q]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pr** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/p[s-z]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/p[-_.:+/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pr** x,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pre[^f]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/pref[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/prefs[^.]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/prefs.[^j]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/prefs.j[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/prefs.js[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/prefs.jso[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/prefs.json x,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/prefs.json?** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/s** x,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/s[a-s]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/s[u-z]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/s[0-9]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/s[-._:+/]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/st[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/sto[^r]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/stor[^a]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/stora[^g]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/storag[^e]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/storage/[^d]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/storage/d**/ls/** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/storage/d**/idb/** x,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/storage/d**/idb/**.files/** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/[v-z]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/u[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/us[^e]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/use[^r]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/user[^.]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/user.[^j]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/user.j[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/user.js** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/user.js?** xw,

deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/[-._:+/]** xrw,
deny /home/*/snap/firefox/common/.[-_ab]** xrw,
deny /home/*/snap/firefox/common/[0-9]** xrw,
deny /home/*/snap/firefox/common/[a-c]** xrw,
deny /home/*/snap/firefox/common/[e-z]** xrw,
deny /home/*/snap/firefox/common/D[^o]** xrw,
deny /home/*/snap/firefox/common/Do[-._:+ab/]** xrw,
deny /home/*/snap/firefox/common/Do[0-9]** xrw,
deny /home/*/snap/firefox/common/Do[d-v]** xrw,
deny /home/*/snap/firefox/common/Do[x-z]** xrw,
deny /home/*/snap/firefox/common/Doc[^u]** xrw,
deny /home/*/snap/firefox/common/Docu[^m]** xrw,
deny /home/*/snap/firefox/common/Docum[^e]** xrw,
deny /home/*/snap/firefox/common/Docume[^n]** xrw,
deny /home/*/snap/firefox/common/Documen[^t]** xrw,
deny /home/*/snap/firefox/common/Document[^s]** xrw,
deny /home/*/snap/firefox/common/Documents[^/]** xrw,
deny /home/*/snap/firefox/common/Documents/** xw,
deny /home/*/snap/firefox/common/Documents?/** xrw,
deny /home/*/snap/firefox/common/Dow[^n]** xrw,
deny /home/*/snap/firefox/common/Down[^l]** xrw,
deny /home/*/snap/firefox/common/Downl[^o]** xrw,
deny /home/*/snap/firefox/common/Downlo[^a]** xrw,
deny /home/*/snap/firefox/common/Downloa[^d]** xrw,
deny /home/*/snap/firefox/common/Download[^s]** xrw,
deny /home/*/snap/firefox/common/Downloads[^/]** xrw,
deny /home/*/snap/firefox/common/Downloads/** x,
deny /home/*/snap/firefox/common[^/]** xrw,
deny /home/*/snap/firefox/cu[^r]** xrw,
deny /home/*/snap/firefox/cur[^r]** xrw,
deny /home/*/snap/firefox/curr[^e]** xrw,
deny /home/*/snap/firefox/curre[^n]** xrw,
deny /home/*/snap/firefox/curren[^t]** xrw,
deny /home/*/snap/firefox/current[^/]** xrw,
deny /home/*/snap/firefox/current/[^.]** xrw,
deny /home/*/snap/firefox/current/.[^l]** xrw,
deny /home/*/snap/firefox/current/.l[^o]** xrw,
deny /home/*/snap/firefox/current/.lo[^c]** xrw,
deny /home/*/snap/firefox/current/.loc[^a]** xrw,
deny /home/*/snap/firefox/current/.loca[^l]** xrw,
deny /home/*/snap/firefox/current/.local[^/]** xrw,
deny /home/*/snap/firefox/current/.local/[^u]** xrw,
deny /home/*/snap/firefox/current/.local/u[^s]** xrw,
deny /home/*/snap/firefox/current/.local/us[^e]** xrw,
deny /home/*/snap/firefox/current/.local/use[^r]** xrw,
deny /home/*/snap/firefox/current/.local/user[^-]** xrw,
deny /home/*/snap/firefox/current/.local/user-[^d]** xrw,
deny /home/*/snap/firefox/current/.local/user-d[^i]** xrw,
deny /home/*/snap/firefox/current/.local/user-di[^r]** xrw,
deny /home/*/snap/firefox/current/.local/user-dir[^s]** xrw,
deny /home/*/snap/firefox/current/.local/user-dirs[^.]** xrw,
deny /home/*/snap/firefox/current/.local/user-dirs.*/** xrw,
deny /home/*/snap/firefox/current/.local/user-dirs.* xw,
deny /home/*/snap/firefox[^/]** xrw,
deny /home/*/snap[^/]** xrw,
deny /home/*/.[-.:+/ab]** xrw,
deny /home/*/.[d-z]** xrw,
deny /home/*/.[0-9]** xrw,
deny /home/*/.[^c]** xrw,
deny /home/*/.c[^o]** xrw,
deny /home/*/.co[^n]** xrw,
deny /home/*/.con[^f]** xrw,
deny /home/*/.conf[^i]** xrw,
deny /home/*/.confi[^g]** xrw,
deny /home/*/.config[^/]** xrw,
deny /home/*/.config/[^u]** xrw,
deny /home/*/.config/u[^s]** xrw,
deny /home/*/.config/us[^e]** xrw,
deny /home/*/.config/use[^r]** xrw,
deny /home/*/.config/user[^-]** xrw,
deny /home/*/.config/user-[^d]** xrw,
deny /home/*/.config/user-d[^i]** xrw,
deny /home/*/.config/user-di[^r]** xrw,
deny /home/*/.config/user-dir[^s]** xrw,
deny /home/*/.config/user-dirs[^.]** xrw,
deny /home/*/.config/user-dirs.[-.:+/]** xrw,
deny /home/*/.config/user-dirs.[a-c]** xrw,
deny /home/*/.config/user-dirs.[e-k]** xrw,
deny /home/*/.config/user-dirs.[m-z]** xrw,
deny /home/*/.config/user-dirs.d[^i]** xrw,
deny /home/*/.config/user-dirs.di[^r]** xrw,
deny /home/*/.config/user-dirs.dir[^s]** xrw,
deny /home/*/.config/user-dirs.dirs*/** xrw,
deny /home/*/.config/user-dirs.dirs?** xrw,
deny /home/*/.config/user-dirs.dirs xw,
deny /home/*/.config/user-dirs.l[^o]** xrw,
deny /home/*/.config/user-dirs.lo[^c]** xrw,
deny /home/*/.config/user-dirs.loc[^a]** xrw,
deny /home/*/.config/user-dirs.loca[^l]** xrw,
deny /home/*/.config/user-dirs.local[^e]** xrw,
deny /home/*/.config/user-dirs.locale*/** xrw,
deny /home/*/.config/user-dirs.locale?** xrw,
deny /home/*/.config/user-dirs.locale xw,

deny /home/$iam/** x,
deny /home/$iam[^/]** x,
deny /home/$iam/** x,
deny /home/$iam/De** xrw,
deny /home/$iam/Dow** xw,
deny /home/$iam/Doc** xr,

#deny /home/$admin/.[^c]** xw,
#deny /home/$admin/s[^n]** x,

deny /media/** xrw,

# --- /proc directory ---
deny /proc/* xrw,
deny /proc/** x,
deny /proc/*/[^m] xrw,
deny /proc/*/m[^a] xrw,
deny /proc/*/ma[^p] xrw,
deny /proc/*/ma[^p] xrw,
deny /proc/*/map[-.:+/]** xrw,
deny /proc/*/map[0-9]** xrw,
deny /proc/*/map[a-r]** xrw,
deny /proc/*/map[t-z]** xrw,
deny /proc/*/map_[^f]** xrw,
deny /proc/*/map_f[^i]** xrw,
deny /proc/*/map_fi[^l]** xrw,
deny /proc/*/map_fil[^e]** xrw,
deny /proc/*/map_file[^s]** xrw,
deny /proc/*/map_files/** xw,
deny /proc/*/map_files[^/]** xrw,
deny /proc/*/maps/** xw,
deny /proc/*/maps[^/]** xrw,
deny /proc/[-_.:+/]** xrw,
deny /proc/[a-z]** xrw,

# --- /run directory ---
# /run/user/1001/doc/
# The above folder serves as a staging ground for uploading other files.
# Blocking it will ban ALL file uploads, without exception. This may be desirable.
# Leaving it unblocked may allow access to arbitrary locations, if an upload is initiated by the user.

deny /run/[-._:+/t]** xrw,
deny /run/[0-9]** xrw,
deny /run/[a-r]** xrw,
deny /run/[v-z]** xrw,
deny /run/s[-._+/z]** xrw,
deny /run/s[0-9]** xrw,
deny /run/s[a-g]** xrw,
deny /run/s[i-m]** xrw,
deny /run/s[o-x]** xrw,
deny /run/sy[^s]** xrw,
deny /run/sys[^t]** xrw,
deny /run/syst[^e]** xrw,
deny /run/syste[^m]** xrw,
deny /run/system[^d]** xrw,
deny /run/systemd[^/]** xrw,
deny /run/systemd/[-._:+/]** xrw,
deny /run/systemd/[a-n]** xrw,
deny /run/systemd/[m-q]** xrw,
deny /run/systemd/[s-z]** xrw,
deny /run/systemd/r[^e]** xrw,
deny /run/systemd/re[^s]** xrw,
deny /run/systemd/res[^o]** xrw,
deny /run/systemd/reso[^l]** xrw,
deny /run/systemd/resol[^v]** xrw,
deny /run/systemd/resolv[^e]** xrw,
deny /run/systemd/resolve[^/]** xrw,
deny /run/systemd/resolve/[a-q]** xrw,
deny /run/systemd/resolve/[t-z]** xrw,
deny /run/systemd/resolve/[-._:+/]** xrw,
deny /run/systemd/resolve/[0-9]** xrw,
deny /run/systemd/resolve/r[^e]** xrw,
deny /run/systemd/resolve/re[^s]** xrw,
deny /run/systemd/resolve/res[^o]** xrw,
deny /run/systemd/resolve/reso[^l]** xrw,
deny /run/systemd/resolve/resol[^v]** xrw,
deny /run/systemd/resolve/resolv[^.]** xrw,
deny /run/systemd/resolve/resolv.[^c]** xrw,
deny /run/systemd/resolve/resolv.c[^o]** xrw,
deny /run/systemd/resolve/resolv.co[^n]** xrw,
deny /run/systemd/resolve/resolv.con[^f]** xrw,
deny /run/systemd/resolve/resolv.conf xw,
deny /run/systemd/resolve/resolv.conf?** xrw,
deny /run/systemd/resolve/s[^t]** xrw,
deny /run/systemd/resolve/st[^u]** xrw,
deny /run/systemd/resolve/stub[^-]** xrw,
deny /run/systemd/resolve/stub-[^r]** xrw,
deny /run/systemd/resolve/stub-r[^e]** xrw,
deny /run/systemd/resolve/stub-re[^s]** xrw,
deny /run/systemd/resolve/stub-res[^o]** xrw,
deny /run/systemd/resolve/stub-reso[^l]** xrw,
deny /run/systemd/resolve/stub-resol[^v]** xrw,
deny /run/systemd/resolve/stub-resolv[^.]** xrw,
deny /run/systemd/resolve/stub-resolv.[^c]** xrw,
deny /run/systemd/resolve/stub-resolv.c[^o]** xrw,
deny /run/systemd/resolve/stub-resolv.co[^n]** xrw,
deny /run/systemd/resolve/stub-resolv.con[^f]** xrw,
deny /run/systemd/resolve/stub-resolv.conf** xw,
deny /run/systemd/resolve/stub-resolv.conf?** xrw,
deny /run/sh[^m]** xrw,
deny /run/shm/[^c]** xrw,
deny /run/shm/c[^u]** xrw,
deny /run/shm/cu[^d]** xrw,
deny /run/shm/cud[^a]** xrw,
deny /run/shm/cuda.*/** xrw,
deny /run/shm/cuda[^.]** xrw,
deny /run/shm[^/]** xrw,
deny /run/sn[^a]** xrw,
deny /run/sna[^p]** xrw,
deny /run/snap[^d]** xrw,
deny /run/snapd[_+:/]** xrw,
deny /run/snapd[a-z]** xrw,
deny /run/snapd[0-9]** xrw,
deny /run/snapd.[^s]** xrw,
deny /run/snapd.s[^o]** xrw,
deny /run/snapd.so[^c]** xrw,
deny /run/snapd.soc[^k]** xrw,
deny /run/snapd.sock[^e]** xrw,
deny /run/snapd.socke[^t]** xrw,
deny /run/snapd.socket*/** xrw,
deny /run/snapd.socket?** xrw,
deny /run/snapd.socket x,
deny /run/snapd-[^s]** xrw,
deny /run/snapd-s[^n]** xrw,
deny /run/snapd-sn[^a]** xrw,
deny /run/snapd-sna[^p]** xrw,
deny /run/snapd-snap.[^s]** xrw,
deny /run/snapd-snap.s[^o]** xrw,
deny /run/snapd-snap.so[^c]** xrw,
deny /run/snapd-snap.soc[^k]** xrw,
deny /run/snapd-snap.sock[^e]** xrw,
deny /run/snapd-snap.socke[^t]** xrw,
deny /run/snapd-snap.socket*/** xrw,
deny /run/snapd-snap.socket?** xrw,
deny /run/snapd-snap.socket x,
deny /run/snapd-snap[^.]** xrw,
deny /run/u[-._:+/]** xrw,
deny /run/u[a-c]** xrw,
deny /run/u[e-r]** xrw,
deny /run/u[t-z]** xrw,
deny /run/u[0-9]** xrw,
deny /run/ud[^e]** xrw,
deny /run/ude[^v]** xrw,
deny /run/udev/[^d]** xrw,
deny /run/udev/d[^a]** xrw,
deny /run/udev/da[^t]** xrw,
deny /run/udev/dat[^a]** xrw,
deny /run/udev/data/* xw,
deny /run/udev/data/+[-._:+/]** xrw,
deny /run/udev/data/+[0-9]** xrw,
deny /run/udev/data/+[a-o]** xrw,
deny /run/udev/data/+[q-t]** xrw,
deny /run/udev/data/+[v-z]** xrw,
deny /run/udev/data/+p[^o]** xrw,
deny /run/udev/data/+po[^w]** xrw,
deny /run/udev/data/+pow[^e]** xrw,
deny /run/udev/data/+powe[^r]** xrw,
deny /run/udev/data/+power[^_]** xrw,
deny /run/udev/data/+power_[^s]** xrw,
deny /run/udev/data/+power_s[^u]** xrw,
deny /run/udev/data/+power_su[^p]** xrw,
deny /run/udev/data/+power_sup[^p]** xrw,
deny /run/udev/data/+power_supp[^l]** xrw,
deny /run/udev/data/+power_suppl[^y]** xrw,
deny /run/udev/data/+power_supply:[^h]** xrw,
deny /run/udev/data/+power_supply:h[^i]** xrw,
deny /run/udev/data/+power_supply:hi[^d]** xrw,
deny /run/udev/data/+power_supply:hid* xw,
deny /run/udev/data/+power_supply:hid*/** xrw,
deny /run/udev/data/+power_supply[^:]** xrw,
# /run/udev/data/+power_supply:hid* xr,
deny /run/udev/data/+u[^s]** xrw,
deny /run/udev/data/+us[^b]** xrw,
deny /run/udev/data/+usb:[-._:+/]** xrw,
deny /run/udev/data/+usb:[0-9]* xw,
deny /run/udev/data/+usb:[0-9]*/** xrw,
deny /run/udev/data/+usb:[a-z]** xrw,
deny /run/udev/data/+usb[^:]** xrw,
deny /run/udev/data/[-._:a/]** xrw,
deny /run/udev/data/[0-9]** xrw,
deny /run/udev/data/[d-m]** xrw,
deny /run/udev/data/[o-z]** xrw,
deny /run/udev/data/b11:[-._:+/]** xrw,
deny /run/udev/data/b11:[0-9]* xw,
deny /run/udev/data/b11:[0-9]*/** xrw,
deny /run/udev/data/b11:[a-z]** xrw,
deny /run/udev/data/b11[^:]** xrw,
deny /run/udev/data/b1:[-._:+]** xrw,
deny /run/udev/data/b1:[0-9]* xw,
deny /run/udev/data/b1:[0-9]*/** xrw,
deny /run/udev/data/b1:[a-z]** xrw,
deny /run/udev/data/b1[-._+]** xrw,
deny /run/udev/data/b1[2-9]** xrw,
deny /run/udev/data/b1[a-z]** xrw,
deny /run/udev/data/b230:[-._:+/]** xrw,
deny /run/udev/data/b230:[0-9]* xw,
deny /run/udev/data/b230:[0-9]*/** xrw,
deny /run/udev/data/b230:[a-z]** xrw,
deny /run/udev/data/b230[^:]** xrw,
deny /run/udev/data/b23[^0]** xrw,
deny /run/udev/data/b2[^3]** xrw,
deny /run/udev/data/b7:[-._:+/]** xrw,
deny /run/udev/data/b7:[0-9]* xw,
deny /run/udev/data/b7:[0-9]*/** xrw,
deny /run/udev/data/b7:[a-z]** xrw,
deny /run/udev/data/b7[^:]** xrw,
deny /run/udev/data/b8:[-._:+/]** rw,
deny /run/udev/data/b8:[0-9]* w,
deny /run/udev/data/b8:[0-9]*/** rw,
deny /run/udev/data/b8:[a-z]** rw,
deny /run/udev/data/b8[^:]** rw,
deny /run/udev/data/b[-._:+9]** xrw,
deny /run/udev/data/b[3-6]** xrw,
deny /run/udev/data/c14:[-._:+]** xrw,
deny /run/udev/data/c14:[0-9]** xw,
deny /run/udev/data/c14:[a-z]** xrw,
deny /run/udev/data/c14[^:]** xrw,
deny /run/udev/data/c1[^4]** xrw,
deny /run/udev/data/c21:[-._:+/]** xrw,
deny /run/udev/data/c21:[0-9]* xw,
deny /run/udev/data/c21:[0-9]*/** xrw,
deny /run/udev/data/c21:[a-z]** xrw,
deny /run/udev/data/c21[^:]** xrw,
deny /run/udev/data/c23[-._:+]** xrw,
deny /run/udev/data/c23[0-3]** xrw,
deny /run/udev/data/c23[4-9]:* xw,
deny /run/udev/data/c23[4-9]:*/** xrw,
deny /run/udev/data/c23[4-9][^:]** xrw,
deny /run/udev/data/c23[a-z]** xrw,
deny /run/udev/data/c24[-._:+/]** xrw,
deny /run/udev/data/c24[0-9]:* xw,
deny /run/udev/data/c24[0-9]:*/** xrw,
deny /run/udev/data/c24[0-9][^:]** xrw,
deny /run/udev/data/c24[a-z]** xrw,
deny /run/udev/data/c25[-._:+/]** xrw,
deny /run/udev/data/c25[0-4]:* xw,
deny /run/udev/data/c25[0-4]:*/** xrw,
deny /run/udev/data/c25[0-4][^:]** xrw,
deny /run/udev/data/c25[5-9]** xrw,
deny /run/udev/data/c25[a-z]** xrw,
deny /run/udev/data/c2[-._:+/02]** xrw,
deny /run/udev/data/c2[6-9]** xrw,
deny /run/udev/data/c2[6-9]** xrw,
deny /run/udev/data/c2[a-z]** xrw,
deny /run/udev/data/c[-._:+/]** xrw,
deny /run/udev/data/c[3-9]** xrw,
deny /run/udev/data/c[a-z]** xrw,
deny /run/udev/data/n[-._:+/]** xrw,
deny /run/udev/data/n[0-9]* xw,
deny /run/udev/data/n[0-9]*/** xrw,
deny /run/udev/data/n[a-z]** xrw,
deny /run/udev/data[^/]** xrw,
deny /run/udev[^/]** xrw,
deny /run/us[^e]** xrw,
deny /run/use[^r]** xrw,
deny /run/user[^/]** xrw,
deny /run/user/[^1]** xrw,
deny /run/user/1[^0]** xrw,
deny /run/user/10[^0]** xrw,
deny /run/user/100[^1]** xrw,
deny /run/user/1001[^/]** xrw,
deny /run/user/1001/[-._:+/ac]** xrw,
deny /run/user/1001/[e-v]** xrw,
deny /run/user/1001/[x-z]** xrw,
deny /run/user/1001/[0-9]** xrw,
deny /run/user/1001/b[^u]** xrw,
deny /run/user/1001/bu[^s]** xrw,
deny /run/user/1001/bus*/** xrw,
deny /run/user/1001/bus?** xrw,
deny /run/user/1001/bus x,
deny /run/user/1001/d[^o]** xrw,
deny /run/user/1001/do[^c]** xrw,
deny /run/user/1001/doc[^/]** xrw,
deny /run/user/1001/doc/by** xrw,
deny /run/user/1001/doc/[g-z]** xrw,
deny /run/user/1001/doc/[-._:+/]** xrw,
deny /run/user/1001/doc/[0-9]* xrw,
deny /run/user/1001/doc/[a-f]* xrw,
deny /run/user/1001/doc/[0-9]*/** xw,
deny /run/user/1001/doc/[a-f]*/** xw,
deny /run/user/1001/w[^a]** xrw,
deny /run/user/1001/wa[^y]** xrw,
deny /run/user/1001/way[^l]** xrw,
deny /run/user/1001/wayl[^a]** xrw,
deny /run/user/1001/wayla[^n]** xrw,
deny /run/user/1001/waylan[^d]** xrw,
deny /run/user/1001/wayland[^-]** xrw,
deny /run/user/1001/wayland-[^0]** xrw,
deny /run/user/1001/wayland-0[^.]** xrw,
deny /run/user/1001/wayland-0.[^l]** xrw,
deny /run/user/1001/wayland-0.l[^o]** xrw,
deny /run/user/1001/wayland-0.lo[^c]** xrw,
deny /run/user/1001/wayland-0.loc[^k]** xrw,
deny /run/user/1001/wayland-0.lock*/** xrw,
deny /run/user/1001/wayland-0.lock?** xrw,
deny /run/user/1001/wayland-0.lock x,
deny /run/user/1001/wayland-0 x,

# --- /sys directory ---
deny /sys/[-._:+a/]** xrw,
deny /sys/[0-9]** xrw,
deny /sys/[e-l]** xrw,
deny /sys/[n-z]** xrw,
deny /sys/b[^u]** xrw,
deny /sys/bu[^s]** xrw,
deny /sys/bus/**/[^d]** xrw,
deny /sys/bus/**/d[^e]** xrw,
deny /sys/bus/**/de[^v]** xrw,
deny /sys/bus/**/dev[^i]** xrw,
deny /sys/bus/**/devi[^c]** xrw,
deny /sys/bus/**/devic[^e]** xrw,
deny /sys/bus/**/device[^s]** xrw,
deny /sys/bus/**/devices/** xw,
deny /sys/bus/**/devices[^/]** xrw,
deny /sys/bus[^/]** xrw,
deny /sys/c[^l]** xrw,
deny /sys/cl[^a]** xrw,
deny /sys/cla[^s]** xrw,
deny /sys/clas[^s]** xrw,
deny /sys/class/[^h] xrw,
deny /sys/class/h[^i] xrw,
deny /sys/class/hi[^d] xrw,
deny /sys/class/hid[^r] xrw,
deny /sys/class/hidr[^a] xrw,
deny /sys/class/hidra[^w] xrw,
deny /sys/class/hidraw/** xw,
deny /sys/class/hidraw[^/] xrw,
deny /sys/class[^/]** xrw,
deny /sys/d[^e]** xrw,
deny /sys/de[^v]** xrw,
deny /sys/dev[^i]** xrw,
deny /sys/devi[^c]** xrw,
deny /sys/devic[^e]** xrw,
deny /sys/device[^s]** xrw,
deny /sys/devices/[-._:+/]** xrw,
deny /sys/devices/[0-9]** xrw,
deny /sys/devices/[a-o]** xrw,
deny /sys/devices/[q-r]** xrw,
deny /sys/devices/[t-z]** xrw,
deny /sys/devices/p[^c]** xrw,
deny /sys/devices/pc[^i]** xrw,
deny /sys/devices/pci0000:00/0** xw,
deny /sys/devices/pci0000:00/[^0]** xrw,
deny /sys/devices/pci0000:00[^/]** xrw,
deny /sys/devices/pci0000:0[^0]** xrw,
deny /sys/devices/pci0000:[^0]** xrw,
deny /sys/devices/pci0000[^:]** xrw,
deny /sys/devices/pci000[^0]** xrw,
deny /sys/devices/pci00[^0]** xrw,
deny /sys/devices/pci0[^0]** xrw,
deny /sys/devices/pci[^0]** xrw,
deny /sys/devices/s[^y]** xrw,
deny /sys/devices/sy[^s]** xrw,
deny /sys/devices/sys[^t]** xrw,
deny /sys/devices/syst[^e]** xrw,
deny /sys/devices/syste[^m]** xrw,
deny /sys/devices/system/[^m]** xrw,
deny /sys/devices/system/m[^e]** xrw,
deny /sys/devices/system/me[^m]** xrw,
deny /sys/devices/system/mem[^o]** xrw,
deny /sys/devices/system/memo[^r]** xrw,
deny /sys/devices/system/memor[^y]** xrw,
deny /sys/devices/system/memory/[^b]** xrw,
deny /sys/devices/system/memory/b[^l]** xrw,
deny /sys/devices/system/memory/bl[^o]** xrw,
deny /sys/devices/system/memory/blo[^c]** xrw,
deny /sys/devices/system/memory/bloc[^k]** xrw,
deny /sys/devices/system/memory/block[^_]** xrw,
deny /sys/devices/system/memory/block_[^s]** xrw,
deny /sys/devices/system/memory/block_s[^i]** xrw,
deny /sys/devices/system/memory/block_si[^z]** xrw,
deny /sys/devices/system/memory/block_siz[^e]** xrw,
deny /sys/devices/system/memory/block_size[^_]** xrw,
deny /sys/devices/system/memory/block_size_[^b]** xrw,
deny /sys/devices/system/memory/block_size_b[^y]** xrw,
deny /sys/devices/system/memory/block_size_by[^t]** xrw,
deny /sys/devices/system/memory/block_size_byt[^e]** xrw,
deny /sys/devices/system/memory/block_size_byte[^s]** xrw,
deny /sys/devices/system/memory/block_size_bytes xw,
deny /sys/devices/system/memory/block_size_bytes*/** xrw,
deny /sys/devices/system/memory[^/]** xrw,
deny /sys/devices/system[^/]** xrw,
deny /sys/devices[^/]** xrw,
deny /sys/m[^o]** xrw,
deny /sys/mo[^d]** xrw,
deny /sys/mod[^u]** xrw,
deny /sys/modu[^l]** xrw,
deny /sys/modul[^e]** xrw,
deny /sys/module/[^t]** xrw,
deny /sys/module/t[^e]** xrw,
deny /sys/module/te[^g]** xrw,
deny /sys/module/teg[^r]** xrw,
deny /sys/module/tegr[^a]** xrw,
deny /sys/module/tegra[^_]** xrw,
deny /sys/module/tegra_[^f]** xrw,
deny /sys/module/tegra_f[^u]** xrw,
deny /sys/module/tegra_fu[^s]** xrw,
deny /sys/module/tegra_fus[^e]** xrw,
deny /sys/module/tegra_fuse/[^p]** xrw,
deny /sys/module/tegra_fuse/p[^a]** xrw,
deny /sys/module/tegra_fuse/pa[^r]** xrw,
deny /sys/module/tegra_fuse/par[^a]** xrw,
deny /sys/module/tegra_fuse/para[^m]** xrw,
deny /sys/module/tegra_fuse/param[^e]** xrw,
deny /sys/module/tegra_fuse/parame[^t]** xrw,
deny /sys/module/tegra_fuse/paramet[^e]** xrw,
deny /sys/module/tegra_fuse/paramete[^r]** xrw,
deny /sys/module/tegra_fuse/parameter[^s]** xrw,
deny /sys/module/tegra_fuse/parameters/[^t]** xrw,
deny /sys/module/tegra_fuse/parameters/t[^e]** xrw,
deny /sys/module/tegra_fuse/parameters/te[^g]** xrw,
deny /sys/module/tegra_fuse/parameters/teg[^r]** xrw,
deny /sys/module/tegra_fuse/parameters/tegr[^a]** xrw,
deny /sys/module/tegra_fuse/parameters/tegra[^_]** xrw,
deny /sys/module/tegra_fuse/parameters/tegra_* xw,
deny /sys/module/tegra_fuse/parameters/tegra_*/** xrw,
deny /sys/module/tegra_fuse/parameters[^/]** xrw,
deny /sys/module/tegra_fuse[^/]** xrw,
deny /sys/module[^/]** xrw,

# --- /usr directory ---
# /usr/share block
deny /usr/[-._:+/]** xrw,
deny /usr/[0-9]** xrw,
deny /usr/[a-k]** xrw,
deny /usr/[m-r]** xrw,
deny /usr/[t-z]** xrw,
deny /usr/l[^i]** xrw,
deny /usr/li[^b]** xrw,
deny /usr/lib/[-_.:+yz/]** xrw,
deny /usr/lib/[0-9]** xrw,
deny /usr/lib/[a-e]** xrw,
deny /usr/lib/[g-r]** xrw,
deny /usr/lib/[t-w]** xrw,
deny /usr/lib/[yz]** xrw,
deny /usr/lib/f[^i]** xrw,
deny /usr/lib/fi[-_.:+/]** xrw,
deny /usr/lib/fi[0-9]** xrw,
deny /usr/lib/fi[a-k]** xrw,
deny /usr/lib/fi[m-q]** xrw,
deny /usr/lib/fi[s-z]** xrw,
deny /usr/lib/fil[^e]** xrw,
deny /usr/lib/file/[^m]** xrw,
deny /usr/lib/file/m[^a]** xrw,
deny /usr/lib/file/ma[^g]** xrw,
deny /usr/lib/file/mag[^i]** xrw,
deny /usr/lib/file/magi[^c]** xrw,
deny /usr/lib/file/magic.[^m]** xrw,
deny /usr/lib/file/magic.m[^g]** xrw,
deny /usr/lib/file/magic.mg[^c]** xrw,
deny /usr/lib/file/magic.mgc xw,
deny /usr/lib/file/magic.mgc*/** xrw,
deny /usr/lib/file/magic.mgc?** xrw,
deny /usr/lib/file/magic[^.]** xrw,
deny /usr/lib/file[^/]** xrw,
deny /usr/lib/fir[^e]** xrw,
deny /usr/lib/fire[^f]** xrw,
deny /usr/lib/firef[^o]** xrw,
deny /usr/lib/firefo[^x]** xrw,
deny /usr/lib/firefox/** xw,
deny /usr/lib/firefox/crashreporter xrw,
deny /usr/lib/firefox/crashreporter.ini xrw,
deny /usr/lib/firefox/update-settings.ini xrw,
deny /usr/lib/firefox/updater xrw,
deny /usr/lib/firefox/updater.ini xrw,
deny /usr/lib/firefox[^/]** xrw,
deny /usr/lib/s[^n]** xrw,
deny /usr/lib/sn[^a]** xrw,
deny /usr/lib/sna[^p]** xrw,
deny /usr/lib/snap[^d]** xrw,
deny /usr/lib/snapd/** w,
deny /usr/lib/snapd/[^s]** xw,
deny /usr/lib/snapd/s[^n]** xw,
deny /usr/lib/snapd/sn[^a]** xw,
deny /usr/lib/snapd/sna[^p]** xw,
deny /usr/lib/snapd/snap[^c]** xw,
deny /usr/lib/snapd/snapc[^t]** xw,
deny /usr/lib/snapd/snapct[^l]** xw,
deny /usr/lib/snapd/snapctl rw,
deny /usr/lib/snapd/snapctl*/** xw,
deny /usr/lib/snapd/snapctl?** xw,
deny /usr/lib/snapd/system-shutdown xrw,
deny /usr/lib/x86_64-linux-gnu/** x,
deny /usr/lib/x86_64-linux-gnu/**agent** xrw,
deny /usr/lib/x86_64-linux-gnu/**avahi** xrw,
deny /usr/lib/x86_64-linux-gnu/**bash** xrw,
deny /usr/lib/x86_64-linux-gnu/**bind** xrw,
deny /usr/lib/x86_64-linux-gnu/**blkid** xrw,
deny /usr/lib/x86_64-linux-gnu/**bluetooth** xrw,
deny /usr/lib/x86_64-linux-gnu/**bluetooth** xrw,
deny /usr/lib/x86_64-linux-gnu/**boot** xrw,
deny /usr/lib/x86_64-linux-gnu/**bridge** xrw,
deny /usr/lib/x86_64-linux-gnu/**bus** xrw,
deny /usr/lib/x86_64-linux-gnu/**cairo** xrw,
deny /usr/lib/x86_64-linux-gnu/**camera** xrw,
deny /usr/lib/x86_64-linux-gnu/**crypt** xrw,
deny /usr/lib/x86_64-linux-gnu/**cups** xrw,
deny /usr/lib/x86_64-linux-gnu/**curl** xrw,
deny /usr/lib/x86_64-linux-gnu/**data** xrw,
deny /usr/lib/x86_64-linux-gnu/**desktop** xrw,
deny /usr/lib/x86_64-linux-gnu/**dispatch** xrw,
deny /usr/lib/x86_64-linux-gnu/**fwupd** xrw,
deny /usr/lib/x86_64-linux-gnu/**geo** xrw,
deny /usr/lib/x86_64-linux-gnu/**gnome-bg** xrw,
deny /usr/lib/x86_64-linux-gnu/**gnomekb** xrw,
deny /usr/lib/x86_64-linux-gnu/**ip** xrw,
deny /usr/lib/x86_64-linux-gnu/**kbd** xrw,
deny /usr/lib/x86_64-linux-gnu/**lapi** xrw,
deny /usr/lib/x86_64-linux-gnu/**loop** xrw,
deny /usr/lib/x86_64-linux-gnu/**map** xrw,
deny /usr/lib/x86_64-linux-gnu/**mobile** xrw,
deny /usr/lib/x86_64-linux-gnu/**net** xrw,
deny /usr/lib/x86_64-linux-gnu/**net** xrw,
deny /usr/lib/x86_64-linux-gnu/**nvme** xrw,
deny /usr/lib/x86_64-linux-gnu/**photo** xrw,
deny /usr/lib/x86_64-linux-gnu/**pipe** xrw,
deny /usr/lib/x86_64-linux-gnu/**proxy** xrw,
deny /usr/lib/x86_64-linux-gnu/**pulse** xrw,
deny /usr/lib/x86_64-linux-gnu/**py** xrw,
deny /usr/lib/x86_64-linux-gnu/**sambda** xrw,
deny /usr/lib/x86_64-linux-gnu/**sane** xrw,
deny /usr/lib/x86_64-linux-gnu/**sensor** xrw,
deny /usr/lib/x86_64-linux-gnu/**sh** xrw,
deny /usr/lib/x86_64-linux-gnu/**shell** xrw,
deny /usr/lib/x86_64-linux-gnu/**speech** xrw,
deny /usr/lib/x86_64-linux-gnu/**speech** xrw,
deny /usr/lib/x86_64-linux-gnu/**su** xrw,
deny /usr/lib/x86_64-linux-gnu/**trace** xrw,
deny /usr/lib/x86_64-linux-gnu/**tracker** xrw,
deny /usr/lib/x86_64-linux-gnu/**weather** rw,
deny /usr/lib/x86_64-linux-gnu/**wire** xrw,
deny /usr/lib/x86_64-linux-gnu/**fs** xrw,
deny /usr/lib/x86_64-linux-gnu/[a-k]** xrw,
deny /usr/lib/x86_64-linux-gnu/[m-v]** xrw,
deny /usr/lib/x86_64-linux-gnu/[x-z]** xrw,
deny /usr/lib/x86_64-linux-gnu/l[^i]** xrw,
deny /usr/lib/x86_64-linux-gnu/li[^b]** xrw,
deny /usr/lib/x86_64-linux-gnu/lib** xxw,
deny /usr/lib/x86_64-linux-gnu/lib[-_.:+as]** xrw,
deny /usr/lib/x86_64-linux-gnu/lib[d-e]** xrw,
deny /usr/lib/x86_64-linux-gnu/lib[h-k]** xrw,
deny /usr/lib/x86_64-linux-gnu/lib[n-q]** xrw,
deny /usr/lib/x86_64-linux-gnu/lib[u-y]** xrw,
deny /usr/lib/x86_64-linux-gnu/w[^e]** xrw,
deny /usr/lib/x86_64-linux-gnu/we[^b]** xrw,
deny /usr/lib/x86_64-linux-gnu/web[^k]** xrw,
deny /usr/lib/x86_64-linux-gnu/webk[^i]** xrw,
deny /usr/lib/x86_64-linux-gnu/webki[^t]** xrw,
deny /usr/lib/x86_64-linux-gnu/webkit2[^g]** xrw,
deny /usr/lib/x86_64-linux-gnu/webkit2g[^t]** xrw,
deny /usr/lib/x86_64-linux-gnu/webkit2gt[^k]** xrw,
deny /usr/lib/x86_64-linux-gnu/webkit2gtk-4.0** xw,
deny /usr/lib/x86_64-linux-gnu/webkit2gtk-4.[^0]** xrw,
deny /usr/lib/x86_64-linux-gnu/webkit2gtk-4[^.]** xrw,
deny /usr/lib/x86_64-linux-gnu/webkit2gtk-[^4]** xrw,
deny /usr/lib/x86_64-linux-gnu/webkit2gtk[^-]** xrw,
deny /usr/lib/x86_64-linux-gnu/webkit[^2]** xrw,
deny /usr/lib/X[-_.:+09/]** xrw,
deny /usr/lib/x[a-n]** xrw,
deny /usr/lib/x[a-n]** xrw,
deny /usr/lib/xo[^r]** xrw,
deny /usr/lib/xor[^g]** xrw,
deny /usr/lib/xorg/** xw,
deny /usr/lib/xorg[^/]** xrw,
deny /usr/lib[^/]** xrw,
deny /usr/s[^h]** xrw,
deny /usr/sh[^a]** xrw,
deny /usr/sha[^r]** xrw,
deny /usr/shar[^e]** xrw,
deny /usr/share/[-._:+/myz]** xrw,
deny /usr/share/[0-9]** xrw,
deny /usr/share/[b-e]** xrw,
deny /usr/share/[g-k]** xrw,
deny /usr/share/[o-z]** xrw,
deny /usr/share/a[^l]** xrw,
deny /usr/share/al[^s]** xrw,
deny /usr/share/als[^a]** xrw,
deny /usr/share/alsa** xw,
deny /usr/share/f[^o]** xrw,
deny /usr/share/fo[^n]** xrw,
deny /usr/share/fon[^t]** xrw,
deny /usr/share/font[-._:+/ab]** xrw,
deny /usr/share/font[0-9]** xrw,
deny /usr/share/font[d-r]** xrw,
deny /usr/share/font[t-z]** xrw,
deny /usr/share/fontco[^n]*/** xrw,
deny /usr/share/fontcon[^f]*/** xrw,
deny /usr/share/fontconf[^i]*/** xrw,
deny /usr/share/fontconfi[^g]*/** xrw,
deny /usr/share/fontconfig/** xw,
deny /usr/share/fonts/** xw,
deny /usr/share/fonts[^/]** xrw,
deny /usr/share/l[^i]** xrw,
deny /usr/share/li[^b]** xrw,
deny /usr/share/lib[^d]** xrw,
deny /usr/share/libd[^r]** xrw,
deny /usr/share/libdr[^m]** xrw,
deny /usr/share/libdrm[^/]** xrw,
deny /usr/share/n[^v]** xrw,
deny /usr/share/nv[^i]** xrw,
deny /usr/share/nvi[^d]** xrw,
deny /usr/share/nvid[^i]** xrw,
deny /usr/share/nvidi[^a]** xrw,
deny /usr/share/nvidia** xw,
deny /usr/share/x[^m]** xrw,
deny /usr/share/xm[^l]** xrw,
deny /usr/share/xml/[^i]** xrw,
deny /usr/share/xml/i[^s]** xrw,
deny /usr/share/xml/is[^o]** xrw,
deny /usr/share/xml/iso-[^c]** xrw,
deny /usr/share/xml/iso-c[^o]** xrw,
deny /usr/share/xml/iso-co[^d]** xrw,
deny /usr/share/xml/iso-cod[^e]** xrw,
deny /usr/share/xml/iso-code[^s]** rw,
deny /usr/share/xml/iso-codes** xw,
deny /usr/share/xml/iso[^-]** xrw,
deny /usr/share/xml[^/]** xrw,
deny /usr/share[^/]** xrw,
EOF_FF

echo "}" >> "$apparmorPath"
chmod a=r "$apparmorPath"
chattr +i "$apparmorPath"

echo "Loading apparmor profile:"
apparmor_parser -r "$apparmorPath"
