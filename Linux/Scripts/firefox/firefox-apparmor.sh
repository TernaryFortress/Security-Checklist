#!/bin/bash

iam="${1:-$(logname)}"
userProfile=$(ls -d /home/$iam/snap/firefox/common/.mozilla/firefox/*.default 2>/dev/null | head -n 1)
apparmorPath="/var/lib/snapd/apparmor/profiles/snap.firefox.firefox"
# Using the /usr/ path creates immutable phantom apparmor profiles that prevent firefox from ever updating.

chattr -i "$apparmorPath"
chmod +w "$apparmorPath"

sed -i ':a;N;$!ba;s/}\s*$//' "$apparmorPath"

cat <<EOF_FF >> "$apparmorPath"
# No editing your own rules!
deny /var/lib/snapd/apparmor/profiles/snap.firefox.firefox xw,
deny /etc/firefox/policies/policies.json xw,
deny $userProfile/user.js xw,

deny /[-_.:+/gftq]** xrw,
deny /[0-9]** xrw,
deny /[a-c]** xrw,
deny /[i-o]** xrw,
deny /[v-z]** xrw,
deny /d[^e]** xrw,
deny /de[^v]** xrw,
deny /dev[^/]** xrw,
deny /e[^t]** xrw,
deny /et[^c]** xrw,
deny /etc[^/]** xrw,
deny /h[^o]** xrw,
deny /ho[^m]** xrw,
deny /hom[^e]** xrw,
deny /home[^/]** xrw,
deny /p[^r]** xrw,
deny /pr[^o]** xrw,
deny /pro[^c]** xrw,
deny /proc[^/]** xrw,
deny /r[^u]** xrw,
deny /ru[^n]** xrw,
deny /run[^/]** xrw,
deny /s[-_z.+/]** xrw,
deny /s[0-9]** xrw,
deny /s[a-m]** xrw,
deny /s[o-x]** xrw,
deny /sn[^a]** xrw,
deny /sna[^p]** xrw,
deny /snap[^/]** xrw,
deny /sy[^s]** xrw,
deny /sys[^/]** xrw,
deny /u[^s]** xrw,
deny /us[^r]** xrw,
deny /usr[^/]** xrw,

deny /home/*/bin/** xrw,
deny /**Desktop** xrw,
deny /**media** xrw,
deny /{,usr/}bin/** xrw,

deny /**bash** xrw,
deny /**sudo** xrw,
deny /**mknod** xwr,
deny /**chmod** xwr,
deny /**chattr** xwr,

# Prevent lateral movement.
deny /**su** x,
deny /**sh** x,
deny /**mv** x,
deny /**cp** x,
deny /**py** x,
deny /**ln** x,
deny /**mount** x,
deny /**remount** x,
deny /**umount** x,

# --- /dev directory ---
/dev/hidraw[0-9] rw,
deny /dev/[-._:+tu]** xrw,
deny /dev/[0-9]** xrw,
deny /dev/[a-c]** xrw,
deny /dev/[e-g]** xrw,
deny /dev/[i-m]** xrw,
deny /dev/[o-r]** xrw,
deny /dev/[w-z]** xrw,
deny /dev/d[^r]** xrw,
deny /dev/dr[^i]** xrw,
deny /dev/dri/ xw,
deny /dev/dri/[-._:+ab/]** xw,
deny /dev/dri/[0-9]** xw,
deny /dev/dri/[d-q]** xw,
deny /dev/dri/[s-z]** xw,
deny /dev/dri/c[^a]** xw,
deny /dev/dri/ca[^r]** xw,
deny /dev/dri/car[^d]** xw,
deny /dev/dri/card[-._:+/]** xw,
deny /dev/dri/card[0-9]*/** xw,
deny /dev/dri/card[a-z]** xw,
deny /dev/dri/r[^e]** xw,
deny /dev/dri/re[^n]** xw,
deny /dev/dri/ren[^d]** xw,
deny /dev/dri/rend[^e]** xw,
deny /dev/dri/rende[^r]** xw,
deny /dev/dri/render[^D]** xw,
deny /dev/dri/renderD[0-9]*/** xw,
deny /dev/dri[^/]** xrw,
deny /dev/h[^i]** xrw,
deny /dev/hi[^d]** xrw,
deny /dev/hid[^r]** xrw,
deny /dev/hidr[^a]** xrw,
deny /dev/hidra[^w]** xrw,
deny /dev/hidraw[-._:+/]** xrw,
deny /dev/hidraw[-._:+/]** xrw,
deny /dev/hidraw[0-9] x,
deny /dev/hidraw[0-9]*/** xrw,
deny /dev/hidraw[0-9]?** xrw,
deny /dev/hidraw[a-z]** xrw,
deny /dev/n[-._:+/]** xrw,
deny /dev/n[0-9]** xrw,
deny /dev/n[a-t]** xrw,
deny /dev/n[w-z]** xrw,
deny /dev/nu[^l]** xrw,
deny /dev/nul[^l]** xrw,
deny /dev/null xw,
deny /dev/null*/** xrw,
deny /dev/null?** xrw,
deny /dev/nv[-._:+/]** xrw,
deny /dev/nv[0-9]** xrw,
deny /dev/nv[a-g]** xrw,
deny /dev/nv[j-l]** xrw,
deny /dev/nv[n-z]** xrw,
deny /dev/nvh[^o]** xrw,
deny /dev/nvho[^s]** xrw,
deny /dev/nvhos[^t]** xrw,
deny /dev/nvhost-*/** xrw,
deny /dev/nvhost[^-]** xrw,
deny /dev/nvi[^d]** xrw,
deny /dev/nvid[^i]** xrw,
deny /dev/nvidi[^a]** xrw,
deny /dev/nvidia*/** xrw,
deny /dev/nvm[^a]** xrw,
deny /dev/nvma[^p]** xrw,
deny /dev/nvmap*/** xrw,
deny /dev/nvmap?* xrw,
deny /dev/s[^h]** xrw,
deny /dev/sh[^m]** xrw,
deny /dev/shm/[^c]** xrw,
deny /dev/shm/c[^u]** xrw,
deny /dev/shm/cu[^d]** xrw,
deny /dev/shm/cud[^a]** xrw,
deny /dev/shm/cuda.*/** xrw,
deny /dev/shm/cuda[^.]** xrw,
deny /dev/shm[^/]** xrw,
deny /dev/v[^c]** xrw,
deny /dev/vc[-._:+/]** xrw,
deny /dev/vc[0-9]** xrw,
deny /dev/vc[a-g]** xrw,
deny /dev/vc[i-r]** xrw,
deny /dev/vc[t-z]** xrw,
deny /dev/vch[^i]** xrw,
deny /dev/vchi[^q]** xrw,
deny /dev/vchiq*/** xrw,
deny /dev/vchiq?** xrw,
deny /dev/vcs[^m]** xrw,
deny /dev/vcsm-[^c]** xrw,
deny /dev/vcsm-c[^m]** xrw,
deny /dev/vcsm-cm[^a]** xrw,
deny /dev/vcsm-cma*/** xrw,
deny /dev/vcsm-cma?** xrw,
deny /dev/vcsm[^-]** xrw,

# --- /etc directory ---
/etc/firefox/certificates/** r,
/etc/firefox/policies/** r,


deny /etc/[-._+:/]** xrw,
deny /etc/[0-9]** xrw,
deny /etc/a[^l]** xrw,
deny /etc/al[^t]** xrw,
deny /etc/alt[^e]** xrw,
deny /etc/alte[^r]** xrw,
deny /etc/alter[^n]** xrw,
deny /etc/altern[^a]** xrw,
deny /etc/alterna[^t]** xrw,
deny /etc/alternat[^i]** xrw,
deny /etc/alternati[^v]** xrw,
deny /etc/alternativ[^e]** xrw,
deny /etc/alternative[^s]** xrw,
deny /etc/alternative[^/]** xrw,
deny /etc/alternative/[^x]** xrw,
deny /etc/alternative/x[^-]** xrw,
deny /etc/alternative/x-[^w]** xrw,
deny /etc/alternative/x-w[^w]** xrw,
deny /etc/alternative/x-ww[^w]** xrw,
deny /etc/alternative/x-www[^-]** xrw,
deny /etc/alternative/x-www-[^b]** xrw,
deny /etc/alternative/x-www-b[^r]** xrw,
deny /etc/alternative/x-www-br[^o]** xrw,
deny /etc/alternative/x-www-bro[^w]** xrw,
deny /etc/alternative/x-www-brow[^s]** xrw,
deny /etc/alternative/x-www-brows[^e]** xrw,
deny /etc/alternative/x-www-browse[^r]** xrw,
deny /etc/alternative/x-www-browser*/** xrw,
deny /etc/alternative/x-www-browser?** xrw,
deny /etc/alternative/x-www-browser xw,
deny /etc/[b-e]** xrw,
deny /etc/[i-q]** xrw,
deny /etc/[s-u]** xrw,
deny /etc/[w-z]** xrw,
deny /etc/f[^i]** xrw,
deny /etc/fi[^r]** xrw,
deny /etc/fir[^e]** xrw,
deny /etc/fire[^f]** xrw,
deny /etc/firef[^o]** xrw,
deny /etc/firefo[^x]** xrw,
deny /etc/firefox/[-._:+ab/]** xrw,
deny /etc/firefox/[0-9]** xrw,
deny /etc/firefox/[d-o]** xrw,
deny /etc/firefox/[q-z]** xrw,
deny /etc/firefox/c[^e]*/** xrw,
deny /etc/firefox/ce[^r]*/** xrw,
deny /etc/firefox/cer[^t]*/** xrw,
deny /etc/firefox/cert[^i]*/** xrw,
deny /etc/firefox/certi[^f]*/** xrw,
deny /etc/firefox/certif[^i]*/** xrw,
deny /etc/firefox/certifi[^c]*/** xrw,
deny /etc/firefox/certific[^a]*/** xrw,
deny /etc/firefox/certifica[^t]*/** xrw,
deny /etc/firefox/certificat[^e]*/** xrw,
deny /etc/firefox/certificate[^s]*/** xrw,
deny /etc/firefox/certificates/** xw,
deny /etc/firefox/certificates[^/]** xrw,
deny /etc/firefox/p[^o]** xrw,
deny /etc/firefox/po[^l]** xrw,
deny /etc/firefox/pol[^i]** xrw,
deny /etc/firefox/poli[^c]** xrw,
deny /etc/firefox/polic[^i]** xrw,
deny /etc/firefox/polici[^e]*/** xrw,
deny /etc/firefox/policie[^s]*/** xrw,
deny /etc/firefox/policies/** xw,
deny /etc/firefox/policies[^/]** xrw,
deny /etc/g[-._+:/]** xrw,
deny /etc/g[0-9]** xrw,
deny /etc/g[a-m]** xrw,
deny /etc/g[n-s]** xrw,
deny /etc/g[u-z]** xrw,
deny /etc/gn[^o]** xrw,
deny /etc/gno[^m]** xrw,
deny /etc/gnom[^e]** xrw,
deny /etc/gnome/[^d]** xrw,
deny /etc/gnome/d[^e]** xrw,
deny /etc/gnome/de[^f]** xrw,
deny /etc/gnome/def[^a]** xrw,
deny /etc/gnome/defa[^u]** xrw,
deny /etc/gnome/defau[^l]** xrw,
deny /etc/gnome/defaul[^t]** xrw,
deny /etc/gnome/default[^s]** xrw,
deny /etc/gnome/defaults.[^l]** xrw,
deny /etc/gnome/defaults.l[^i]** xrw,
deny /etc/gnome/defaults.li[^s]** xrw,
deny /etc/gnome/defaults.lis[^t]** xrw,
deny /etc/gnome/defaults.list xw,
deny /etc/gnome/defaults.list*/** xrw,
deny /etc/gnome/defaults.list?** xrw,
deny /etc/gnome/defaults[^.]** xrw,
deny /etc/gnome[^/]** xrw,
deny /etc/gt[^k]** xrw,
deny /etc/gtk-*/* xw,
deny /etc/gtk[^-]** xrw,
deny /etc/h[-._+:/]** xrw,
deny /etc/h[0-9]** xrw,
deny /etc/h[^o]** xrw,
deny /etc/ho[^s]** xrw,
deny /etc/hos[^t]** xrw,
deny /etc/host.[^c]** xrw,
deny /etc/host.c[^o]** xrw,
deny /etc/host.co[^n]** xrw,
deny /etc/host.con[^f]** xrw,
deny /etc/host.conf xw,
deny /etc/host.conf*/** xrw,
deny /etc/host.conf?** xrw,
deny /etc/host[-_+:]** xrw,
deny /etc/host[0-9]** xrw,
deny /etc/host[a-m]** xrw,
deny /etc/host[o-r]** xrw,
deny /etc/host[t-z]** xrw,
deny /etc/hostn[^a]** xrw,
deny /etc/hostna[^m]** xrw,
deny /etc/hostnam[^e]** xrw,
deny /etc/hostname xw,
deny /etc/hostname*/** xrw,
deny /etc/hostname?** xrw,
deny /etc/hosts xw,
deny /etc/hosts.[-_+:bc]** xrw,
deny /etc/hosts.[0-9]** xrw,
deny /etc/hosts.[e-z]** xrw,
deny /etc/hosts.a[^l]** xrw,
deny /etc/hosts.al[^l]** xrw,
deny /etc/hosts.all[^o]** xrw,
deny /etc/hosts.allo[^w]** xrw,
deny /etc/hosts.allow xw,
deny /etc/hosts.allow*/** xrw,
deny /etc/hosts.allow?** xrw,
deny /etc/hosts.d[^e]** xrw,
deny /etc/hosts.de[^n]** xrw,
deny /etc/hosts.den[^y]** xrw,
deny /etc/hosts.deny xw,
deny /etc/hosts.deny*/** xrw,
deny /etc/hosts.deny?** xrw,
deny /etc/hosts[^.]** xrw,
deny /etc/r[^e]** xrw,
deny /etc/re[^s]** xrw,
deny /etc/res[^o]** xrw,
deny /etc/reso[^l]** xrw,
deny /etc/resol[^v]** xrw,
deny /etc/resolv.[^c]** xrw,
deny /etc/resolv.c[^o]** xrw,
deny /etc/resolv.co[^n]** xrw,
deny /etc/resolv.con[^f]** xrw,
deny /etc/resolv.conf xw,
deny /etc/resolv.conf*/** xrw,
deny /etc/resolv.conf?** xrw,
deny /etc/resolv[^.]** xrw,
deny /etc/v[^d]** xrw,
deny /etc/vd[^p]** xrw,
deny /etc/vdp[^a]** xrw,
deny /etc/vdpa[^u]** xrw,
deny /etc/vdpau[^_]** xrw,
deny /etc/vdpau_[^w]** xrw,
deny /etc/vdpau_w[^r]** xrw,
deny /etc/vdpau_wr[^a]** xrw,
deny /etc/vdpau_wra[^p]** xrw,
deny /etc/vdpau_wrap[^p]** xrw,
deny /etc/vdpau_wrapp[^e]** xrw,
deny /etc/vdpau_wrappe[^r]** xrw,
deny /etc/vdpau_wrapper.[^c]** xrw,
deny /etc/vdpau_wrapper.c[^f]** xrw,
deny /etc/vdpau_wrapper.cf[^g]** xrw,
deny /etc/vdpau_wrapper.cfg xw,
deny /etc/vdpau_wrapper.cfg*/** xrw,
deny /etc/vdpau_wrapper.cfg?** xrw,
deny /etc/vdpau_wrapper[^.]** xrw,

# --- /home directory ---
/home/*/Documents/** r,
/home/*/Downloads/** w,

# As of now, we deny access to even the admin profiles.
# "/home/*/snap/firefox/common/.mozilla/" directory contains /firefox and /extensions directories.
#
# There are also some potentially problematic telemetry options that websites might have unrestricted access to.
# /home/*/snap/firefox/common/.mozilla/**.default

deny /home/*/[-_:+/]** xrw,
deny /home/*/[0-9]** xrw,
deny /home/*/[a-c]** xrw,
deny /home/*/[e-r]** xrw,
deny /home/*/[t-z]** xrw,
deny /home/*/D[^o]** xrw,
deny /home/*/Do[-._+:ab/]** xrw,
deny /home/*/Do[0-9]** xrw,
deny /home/*/Do[d-v]** xrw,
deny /home/*/Do[x-z]** xrw,
deny /home/*/Doc[^u]** xrw,
deny /home/*/Docu[^m]** xrw,
deny /home/*/Docum[^e]** xrw,
deny /home/*/Docume[^n]** xrw,
deny /home/*/Documen[^t]** xrw,
deny /home/*/Document[^s]** xrw,
deny /home/*/Documents[^/]** xrw,
deny /home/*/Documents?/** xrw,
deny /home/*/Documents/** xw,
deny /home/*/Dow[^n]** xrw,
deny /home/*/Down[^l]** xrw,
deny /home/*/Downl[^o]** xrw,
deny /home/*/Downlo[^a]** xrw,
deny /home/*/Downloa[^d]** xrw,
deny /home/*/Download[^s]** xrw,
deny /home/*/Downloads[^/]** xrw,
deny /home/*/Downloads?/** xrw,
deny /home/*/Downloads/** x,
deny /home/*/s[^n]** xrw,
deny /home/*/sn[^a]** xrw,
deny /home/*/sna[^p]/** xrw,
deny /home/*/snap/[^f]** xrw,
deny /home/*/snap/f[^i]** xrw,
deny /home/*/snap/fi[^r]** xrw,
deny /home/*/snap/fir[^e]** xrw,
deny /home/*/snap/fire[^f]** xrw,
deny /home/*/snap/firef[^o]** xrw,
deny /home/*/snap/firefo[^x]** xrw,
deny /home/*/snap/firefox/[-.:+/ab]** xrw,
deny /home/*/snap/firefox/[0-9]** xrw,
deny /home/*/snap/firefox/[d-z]** xrw,
deny /home/*/snap/firefox/c[-.:+/ab]** xrw,
deny /home/*/snap/firefox/c[0-9]** xrw,
deny /home/*/snap/firefox/c[a-n]** xrw,
deny /home/*/snap/firefox/c[p-t]** xrw,
deny /home/*/snap/firefox/c[v-z]** xrw,
deny /home/*/snap/firefox/co[^m]** xrw,
deny /home/*/snap/firefox/com[^m]** xrw,
deny /home/*/snap/firefox/comm[^o]** xrw,
deny /home/*/snap/firefox/commo[^n]** xrw,
deny /home/*/snap/firefox/common/.[0-9]** xrw,
deny /home/*/snap/firefox/common/.[d-l]** xrw,
deny /home/*/snap/firefox/common/.[n-z]** xrw,
deny /home/*/snap/firefox/common/.c[^a]** xrw,
deny /home/*/snap/firefox/common/.ca[^c]** xrw,
deny /home/*/snap/firefox/common/.cac[^h]** xrw,
deny /home/*/snap/firefox/common/.cach[^e]** xrw,
deny /home/*/snap/firefox/common/.cache[^/]** xrw,
deny /home/*/snap/firefox/common/.cache/[^m]** xrw,
deny /home/*/snap/firefox/common/.cache/m[^o]** xrw,
deny /home/*/snap/firefox/common/.cache/mo[^z]** xrw,
deny /home/*/snap/firefox/common/.cache/moz[^i]** xrw,
deny /home/*/snap/firefox/common/.cache/mozi[^l]** xrw,
deny /home/*/snap/firefox/common/.cache/mozil[^l]** xrw,
deny /home/*/snap/firefox/common/.cache/mozill[^a]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla[^/]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/[^f]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/f[^i]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/fi[^r]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/fir[^e]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/fire[^f]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firef[^o]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefo[^x]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox[^/]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**[^.]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.[^d]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.d[^e]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.de[^f]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.def[^a]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.defa[^u]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.defau[^l]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.defaul[^t]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.default[^/]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.default/[-._:+/ab]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.default/[d-r]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.default/s** xw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.default/[u-z]** xrw,
deny /home/*/snap/firefox/common/.cache/mozilla/firefox/**.default/[0-9]** xrw,

# activity-stream, safebrowsing folder, thumbnails, cache2, and startupCache.
deny /home/*/snap/firefox/common/.m[^o]** xrw,
deny /home/*/snap/firefox/common/.mo[^z]** xrw,
deny /home/*/snap/firefox/common/.moz[^i]** xrw,
deny /home/*/snap/firefox/common/.mozi[^l]** xrw,
deny /home/*/snap/firefox/common/.mozil[^l]** xrw,
deny /home/*/snap/firefox/common/.mozill[^a]** xrw,
deny /home/*/snap/firefox/common/.mozilla[^/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/[^f]** xrw,
deny /home/*/snap/firefox/common/.mozilla/f[^i]** xrw,
deny /home/*/snap/firefox/common/.mozilla/fi[^r]** xrw,
deny /home/*/snap/firefox/common/.mozilla/fir[^e]** xrw,
deny /home/*/snap/firefox/common/.mozilla/fire[^f]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firef[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefo[^x]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox[^/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/Crash** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/Pending** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/profile** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.def[^a]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.defa[^u]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.defau[^l]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.defaul[^t]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default[^/]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/a[^d]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/ad[^d]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/add[^o]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addo[^n]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addon[^s]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons[a-r]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons[t-z]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons[-_:+/]** xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons.[^j]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons.j[^s]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons.js[^o]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons.jso[^n]** xrw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons.json xw,
deny /home/*/snap/firefox/common/.mozilla/firefox/**.default/addons.json?** xrw,
deny /home/*/s
